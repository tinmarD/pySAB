<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Matlab Dataset Creation, EEGrec, EEGenc &#8212; Sab Analysis 0 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <link rel="stylesheet" href="../_static/my-styles.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Sab Analysis</a>
        <span class="navbar-text navbar-version pull-left"><b>0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="#">Datasets</a></li>
                <li><a href="api.html">API</a></li>
                <li><a href="modules.html">Modules</a></li>
                <li><a href="../auto_examples/index.html">Examples</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">pySAB</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">General Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html#decoding-example">Decoding example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html#erp-example">ERP example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html#phase-utils-example">Phase Utils example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html#time-features-examples">Time Features examples</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/rst/dataset_creation.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Matlab Dataset Creation, EEGrec, EEGenc</a><ul>
<li><a class="reference internal" href="#export-eprime-files-to-txt-files">Export eprime files to <em>.txt</em> files</a><ul>
<li><a class="reference internal" href="#naming-conventions"><strong>Naming Conventions</strong></a></li>
<li><a class="reference internal" href="#rec-files"><strong>REC files</strong></a></li>
<li><a class="reference internal" href="#enc-files"><strong>ENC files</strong></a></li>
</ul>
</li>
<li><a class="reference internal" href="#matlab-scripts">MATLAB scripts</a><ul>
<li><a class="reference internal" href="#time-offset-between-eeg-files-and-eprime-files">Time offset between EEG files and Eprime files</a></li>
<li><a class="reference internal" href="#sab-getdatasets-m">sab_getdatasets.m</a></li>
<li><a class="reference internal" href="#generated-files">Generated files</a></li>
<li><a class="reference internal" href="#sab-rejectepochs-m">sab_rejectepochs.m</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div id="sourcelink">
  <a href="../_sources/rst/dataset_creation.rst.txt"
     rel="nofollow">Source</a>
</div>
<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="matlab-dataset-creation-eegrec-eegenc">
<h1>Matlab Dataset Creation, EEGrec, EEGenc<a class="headerlink" href="#matlab-dataset-creation-eegrec-eegenc" title="Permalink to this headline">¶</a></h1>
<p>This document show how to create the SAB dataset. These datasets will allow you to run further analyses using the pySAB API.
They are created with Matlab scripts available <a class="reference external" href="https://github.com/tinmarD/pySAB/tree/master/SAB_datasetCreation">here</a></p>
<dl class="docutils">
<dt>The procedure is described here :</dt>
<dd><ol class="first last arabic simple">
<li>Convert the eprime file into text files.</li>
<li>Organize your data files in .EDF format and your results text files obtained from the first step</li>
<li>Use the MATLAB scripts to create the datasets</li>
</ol>
</dd>
</dl>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#export-eprime-files-to-txt-files" id="id1">Export eprime files to <em>.txt</em> files</a><ul>
<li><a class="reference internal" href="#naming-conventions" id="id2"><strong>Naming Conventions</strong></a></li>
<li><a class="reference internal" href="#rec-files" id="id3"><strong>REC files</strong></a></li>
<li><a class="reference internal" href="#enc-files" id="id4"><strong>ENC files</strong></a></li>
</ul>
</li>
<li><a class="reference internal" href="#matlab-scripts" id="id5">MATLAB scripts</a><ul>
<li><a class="reference internal" href="#time-offset-between-eeg-files-and-eprime-files" id="id6">Time offset between EEG files and Eprime files</a></li>
<li><a class="reference internal" href="#sab-getdatasets-m" id="id7">sab_getdatasets.m</a></li>
<li><a class="reference internal" href="#generated-files" id="id8">Generated files</a></li>
<li><a class="reference internal" href="#sab-rejectepochs-m" id="id9">sab_rejectepochs.m</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="export-eprime-files-to-txt-files">
<h2><a class="toc-backref" href="#id1">Export eprime files to <em>.txt</em> files</a><a class="headerlink" href="#export-eprime-files-to-txt-files" title="Permalink to this headline">¶</a></h2>
<div class="section" id="naming-conventions">
<h3><a class="toc-backref" href="#id2"><strong>Naming Conventions</strong></a><a class="headerlink" href="#naming-conventions" title="Permalink to this headline">¶</a></h3>
<p>For REC files, name the file “SAB_REC_1_600ms.txt” where 1 is the file number, 600ms is the maximal reaction time.
For ENC files, replace “REC” by “ENC”. It is important the that the file number is on 3rd position (with respect to
the ‘_’ separators). The maximum reaction time is not mandatory.</p>
</div>
<div class="section" id="rec-files">
<h3><a class="toc-backref" href="#id3"><strong>REC files</strong></a><a class="headerlink" href="#rec-files" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>First select the following columns :</dt>
<dd><ul class="first last simple">
<li>reponseReco1.OnsetTime : image onset time</li>
<li>reponseReco1.RTTime : subject response time : time at which it raises his finger from the response box</li>
<li>reponseReco1.RT : reaction time, i.e. = OnsetTime - RTTime</li>
<li>reponseReco1.RESP : subject response, 1 if he/she thinks the image was show before, 0 otherwise</li>
<li>eponseReco1.CRESP : correct response, 1 if the image was show before, 0 otherwise</li>
<li>image : image name</li>
</ul>
</dd>
</dl>
<a class="reference internal image-reference" href="../_images/conv_eprime.png"><img alt="../_images/conv_eprime.png" src="../_images/conv_eprime.png" style="width: 1000px;" /></a>
<p>Then <strong>export</strong> the selected columns to a text file. Go in File/Export/… Use the following parameters :</p>
<a class="reference internal image-reference" href="../_images/conv_eprime_2.png"><img alt="../_images/conv_eprime_2.png" src="../_images/conv_eprime_2.png" style="width: 1000px;" /></a>
</div>
<div class="section" id="enc-files">
<h3><a class="toc-backref" href="#id4"><strong>ENC files</strong></a><a class="headerlink" href="#enc-files" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>For the encoding phase files, you only need the following columns :</dt>
<dd><ul class="first last simple">
<li>stimEnco1.OnsetTime : image onset time</li>
<li>image : image name</li>
</ul>
</dd>
</dl>
</div>
</div>
<div class="section" id="matlab-scripts">
<h2><a class="toc-backref" href="#id5">MATLAB scripts</a><a class="headerlink" href="#matlab-scripts" title="Permalink to this headline">¶</a></h2>
<p>You will need EEGLAB to run the scripts</p>
<div class="section" id="time-offset-between-eeg-files-and-eprime-files">
<h3><a class="toc-backref" href="#id6">Time offset between EEG files and Eprime files</a><a class="headerlink" href="#time-offset-between-eeg-files-and-eprime-files" title="Permalink to this headline">¶</a></h3>
<p>The starting time of the Eprime software differs from the starting time of the iEEG recordings. Thus an offset exists
between the times in the Eprime files (and converted text files) and the time in the iEEG <em>.edf</em> files. To synchronize
both files we use the trigger corresponding to the onset of the first image, which must correponds to the time of the first
image in the Eprime file. This is done in the <code class="docutils literal notranslate"><span class="pre">sab_getdatasets.m</span></code> script.</p>
<p>This is illustrated bellow.</p>
<img alt="../_images/trigger_eeg_eprime.png" src="../_images/trigger_eeg_eprime.png" />
</div>
<div class="section" id="sab-getdatasets-m">
<h3><a class="toc-backref" href="#id7">sab_getdatasets.m</a><a class="headerlink" href="#sab-getdatasets-m" title="Permalink to this headline">¶</a></h3>
<p>The main MATLAB script for creating dataset is <code class="docutils literal notranslate"><span class="pre">sab_getdatasets.m</span></code>. This script can be used as a function or run like
a script.</p>
<p><strong>Note that a lot of parameters are defined in the first lines of this file, you will need to modify some of them</strong>.
They are detailed here :</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">rec_only</span></code> : If set to 1, only the dataset for REC files will be created.</li>
<li><code class="docutils literal notranslate"><span class="pre">save_mat</span></code> : Should be set to 1, otherwise the datasets will not be saved.</li>
<li><code class="docutils literal notranslate"><span class="pre">EPOCH_TIME_BEFORE_STIM</span></code> : Time taken before stimuli onsets to create the epochs</li>
<li><code class="docutils literal notranslate"><span class="pre">EPOCH_TIME_AFTER_STIM</span></code> : Time taken after stimuli onsets to create the epochs</li>
<li><code class="docutils literal notranslate"><span class="pre">TRIGGER_THRESHOLD_MACRO</span></code> : Triggers in Macro files will be detected if superior to this threshold</li>
<li><code class="docutils literal notranslate"><span class="pre">TRIGGER_THRESHOLD_MICRO</span></code> : Triggers in micro files will be detected if superior to this threshold</li>
</ul>
</div></blockquote>
<p>The script will first ask the user to select the directory containing the EEG files in the <em>.edf</em> format and the
directory containing the results text files.</p>
<p>The script will then print what files have been detected and how the correpondency between EEG file and results file
has been done. <strong>Check that the correpondency is correct!</strong></p>
<p><em>Example :</em></p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">8 ENC edf files found.</span>
<span class="go">8 REC edf files found.</span>
<span class="go">0 ENC eprime files found.</span>
<span class="go">8 REC eprime files found.</span>
<span class="go">REC files correspondence:</span>
<span class="go">SAB_REC_1_500ms.edf &lt;------&gt; SAB_REC_1_500ms.txt</span>
<span class="go">SAB_REC_2_500ms.edf &lt;------&gt; SAB_REC_2_500ms.txt</span>
<span class="go">SAB_REC_3_500ms.edf &lt;------&gt; SAB_REC_3_500ms.txt</span>
<span class="go">SAB_REC_4_500ms.edf &lt;------&gt; SAB_REC_4_500ms.txt</span>
<span class="go">SAB_REC_5_500ms.edf &lt;------&gt; SAB_REC_5_500ms.txt</span>
<span class="go">SAB_REC_6_500ms.edf &lt;------&gt; SAB_REC_6_500ms.txt</span>
<span class="go">SAB_REC_7_500ms.edf &lt;------&gt; SAB_REC_7_500ms.txt</span>
<span class="go">SAB_REC_8_500ms.edf &lt;------&gt; SAB_REC_8_500ms.txt</span>
</pre></div>
</div>
</div></blockquote>
<p>User is then asked if triggers are doubled. In some files, triggers always appears by 2 where there should be only 1.
The script try to detect it automatically weither it is the case or not.</p>
<p>The script try to detect bad channels and ask for confirmation. <strong>Note that you can only decide to remove all the
bad detected channels or none</strong>.</p>
</div>
<div class="section" id="generated-files">
<h3><a class="toc-backref" href="#id8">Generated files</a><a class="headerlink" href="#generated-files" title="Permalink to this headline">¶</a></h3>
<p><strong>Output Path</strong></p>
<p>The script create the dataset along side the data directory containing the <em>.edf</em> files.</p>
<p><strong>Output Files</strong></p>
<p>The output directory should look like this :</p>
<img alt="../_images/dataset_creation_output_path.png" src="../_images/dataset_creation_output_path.png" />
<dl class="docutils">
<dt>Here only the REC dataset was created. The output files are :</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">EEGrec.mat</span></code> : EEGLAB epoch dataset, for REC files.</li>
<li><code class="docutils literal notranslate"><span class="pre">correctRejects</span></code> : vector containing 1 if the trial was a correct reject, 0 otherwise</li>
<li><code class="docutils literal notranslate"><span class="pre">hits</span></code> : vector containing 1 if the trial was a hit, 0 otherwise</li>
<li><code class="docutils literal notranslate"><span class="pre">falseAlarms</span></code> : vector containing 1 if the trial was a false alarm, 0 otherwise</li>
<li><code class="docutils literal notranslate"><span class="pre">omissions</span></code> : vector containing 1 if the trial was an omission, 0 otherwise</li>
<li><code class="docutils literal notranslate"><span class="pre">imageNames</span></code> : vector containing each image name</li>
<li><code class="docutils literal notranslate"><span class="pre">reactionTimes</span></code> : vector containing the reaction time for each trial (for hits and false alarms, 0 otherwise)</li>
</ul>
</dd>
</dl>
<p>These files will be needed for further analyses : <strong>the SabDataset python class is created from these files.</strong></p>
</div>
<div class="section" id="sab-rejectepochs-m">
<h3><a class="toc-backref" href="#id9">sab_rejectepochs.m</a><a class="headerlink" href="#sab-rejectepochs-m" title="Permalink to this headline">¶</a></h3>
<p>The file <code class="docutils literal notranslate"><span class="pre">sab_rejectepochs.m</span></code> can be used to check visually the epochs, using the EEGLAB interface. You can use it to
mark the bad epochs and reject them.</p>
<p>You will need to modify the first lines of the script :</p>
<blockquote>
<div></div></blockquote>
<p>The interface show all epochs in a row. To select an epoch, just click on it. When done, click on “UPDATE MARKS” and confirm
when asked to reject epochs. Bad epochs should now be rejected.</p>
<img alt="../_images/eeglab_epochs.png" src="../_images/eeglab_epochs.png" />
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2017, Martin Deudon.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>